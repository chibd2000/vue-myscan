"use strict";(self["webpackChunkvue3_element_plus_demo_test"]=self["webpackChunkvue3_element_plus_demo_test"]||[]).push([[632],{7237:function(e,a,l){l.d(a,{A7:function(){return u},jL:function(){return o},zk:function(){return n}});var t=l(2884);const u=e=>{const a={page_num:1,page_size:1};return a.page_num=e.page_num,a.page_size=e.page_size,t.Z.get(`/poc/${a.page_num}/${a.page_size}`)},n=()=>t.Z.get("/poc/sync"),o=e=>{const a={query:""};return""==e.query?a.query="null":a.query=e.query,t.Z.get(`/poc/treepoc/${a.query}`)}},916:function(e,a,l){l.d(a,{Ir:function(){return r},Lp:function(){return p},Oj:function(){return s},bI:function(){return u},bU:function(){return n},eX:function(){return i},m9:function(){return o},qc:function(){return d}});var t=l(2884);const u=e=>{const a={page_num:1,page_size:1,query:"",search_type:""};return a.page_num=e.page_num,a.page_size=e.page_size,a.search_type=e.search_type,""==e.query?a.query="null":a.query=e.query,t.Z.get(`/task/${a.search_type}/${a.page_num}/${a.page_size}/${a.query}`)},n=e=>t.Z.post("/task",e),o=e=>t.Z["delete"]("/task",{data:e}),i=e=>t.Z.post("/common/website/export_website",{domain_id_list:e}),s=e=>t.Z.post("/common/ip/export_private_ip",{domain_id_list:e}),r=e=>t.Z.post("/common/ip/export_ip_port",{domain_id_list:e}),d=e=>t.Z.post("/common/subdomain/export_subdomain",{domain_id_list:e}),p=e=>t.Z.get(`/task/count/${e}`)},8842:function(e,a,l){l.d(a,{He:function(){return u},R7:function(){return n},UB:function(){return t},tY:function(){return o}});const t=[{value:"space",label:"空间搜索引擎验证"},{value:"ip",label:"IP/IP段验证"}],u=[{value:"1",label:"已完成"},{value:"0",label:"未完成"}],n=[{value:"attack",label:"探测和利用"},{value:"detect",label:"仅探测"},{value:"exec",label:"仅利用"}],o=[{prop:"name",label:"任务名称",width:150},{prop:"domain",label:"目标",width:225},{prop:"config",label:"配置项",width:150},{prop:"status",label:"状态",width:120},{prop:"scanning_start_time",label:"开始时间",width:200},{prop:"scanning_end_time",label:"结束时间",width:200},{prop:"domain_id",label:"任务ID",width:300}]},6632:function(e,a,l){l.r(a),l.d(a,{default:function(){return z}});l(7658);var t=l(3396),u=l(4870),n=l(7139),o=l(2748),i=l(8842),s=l(2884);const r=e=>{const a={page_num:1,page_size:1,query:"",search_type:""};return a.page_num=e.page_num,a.page_size=e.page_size,a.search_type=e.search_type,""==e.query?a.query="null":a.query=e.query,s.Z.get(`/verify/${a.search_type}/${a.page_num}/${a.page_size}/${a.query}`)},d=e=>s.Z.post("/verify",e),p=e=>s.Z["delete"](`/verify/${e}`);var m=l(916),_=l(7178),c=l(2655),v=l(8730),f=l(7237),w=l(2483);const k=(0,u.qj)({task_name:[{message:"任务名称不能为空...",required:!0,trigger:"blur"}],task_target:[{message:"任务目标不能为空...",required:!0,trigger:"blur"}]}),y={class:"demo-pagination-block"},g={class:"dialog-footer"};var b=(0,t.aZ)({__name:"Verify",setup(e){const a=(0,u.iH)(!1),l=(0,u.iH)(!1),s=(0,u.iH)(!1),b=(0,u.iH)(!1),h=(0,u.iH)(!1),W=(0,w.tv)(),z=(0,u.iH)(""),U=(0,u.iH)(""),V=(0,u.iH)({query:"",page_size:10,page_num:1,search_type:""}),C=(0,u.iH)([]),q=(0,u.iH)(),H=(0,u.iH)(),x=(0,u.iH)(),Z=async e=>{"name"==e?(V.value.search_type=e,V.value.query=z.value):"domainid"==e&&(V.value.search_type=e,V.value.query=U.value);const a=await r(V.value);C.value=a.data.verifys,q.value=a.data.total;const l=await(0,m.Lp)("verify");H.value=l.data.finished,x.value=l.data.all_total};Z("name");const $=()=>{Z("name")},S=()=>{Z("domainid")},j=(0,u.iH)("fofa"),D=e=>{I.value.task_verify_space=e},P=(0,u.iH)(),I=(0,u.iH)({task_name:"",task_target:"",task_service:!1,task_web:!0,task_web_poc:"",task_web_poc_type:"",task_port:!1,task_port_content:"",task_proxy:"",task_verify_type:"space",task_verify_space:"fofa"}),K=async e=>{e.validate((async a=>{if(!a)return!1;b.value=!0,ue.value&&(I.value.task_web_poc="all_poc"),await d(I.value).then((()=>{(0,_.z8)({message:"添加任务成功",type:"success"})}),(e=>{(0,_.z8)({message:"添加任务失败",type:"error"})})),b.value=!1,ue.value=!1,e.resetFields(),Z("name")}))},O=e=>{ae.value=!1,b.value=!1,e.resetFields(),ee.value.setCheckedKeys([],!1)},Y=async e=>{alert("this_is_restart_click"),Z("name")},B=async e=>{await p(e).then((()=>{(0,_.z8)({message:"删除任务成功",type:"success"})}),(e=>{(0,_.z8)({message:"删除任务失败",type:"error"})})),Z("name")},L=((0,u.iH)(),()=>{c.T.confirm("proxy will permanently delete the file. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{await(0,m.m9)(F.value).then((()=>{(0,_.z8)({message:"删除任务成功",type:"success"})}),(e=>{(0,_.z8)({message:"删除任务失败",type:"error"})})),Z("name")})).catch((()=>{(0,_.z8)({type:"info",message:"Delete canceled"})}))}),F=(0,u.iH)([]),T=(0,u.iH)(!0),R=e=>{e.length?T.value=!1:T.value=!0,F.value=[];for(let a=0;a<e.length;a++)F.value.push(e[a].domain_id)},A=e=>{V.value.page_num=1,V.value.page_size=e,Z("name")},E=e=>{V.value.page_num=e,Z("name")},N=(0,u.iH)({query:""}),X={label:"label",children:"children",id:"id"},G=(0,u.iH)(),J=(0,u.iH)(0),M=()=>{h.value=!0,Q()},Q=async()=>{const e=await(0,f.jL)(N.value);G.value=e.data.pocs,J.value=e.data.total},ee=(0,u.iH)(),ae=(0,u.iH)(!1),le=()=>{const e=ee.value.getCheckedKeys(!1),a=[];e.forEach((e=>{void 0!=e&&a.push(e)})),I.value.task_web_poc=a.join(","),""==I.value.task_web_poc&&(I.value.task_web_poc="all_poc"),ae.value=!0,h.value=!1},te=e=>{h.value=!1,ee.value.setCheckedKeys([],!1),e.resetFields(),ne.value=""},ue=(0,u.iH)(!1),ne=(0,u.iH)(""),oe=()=>{ee.value.setCheckedKeys([...J.value+1],!0),ue.value=!0};(0,t.YP)(ne,(e=>{ee.value.filter(e)}));const ie=(e,a)=>!e||a.label.includes(e),se=(0,u.iH)(!1),re=(0,u.iH)("空间搜索引擎验证"),de=(0,u.iH)("探测和利用"),pe=e=>{"ip"==e?(se.value=!0,I.value.task_port=!0,I.value.task_verify_type="ip"):"space"==e&&(se.value=!1,I.value.task_port=!1,I.value.task_verify_type="space")},me=e=>{W.push({path:"/detail",query:{domain_id:e}})};return(e,r)=>{const d=(0,t.up)("el-button"),p=(0,t.up)("el-input"),m=(0,t.up)("el-form-item"),_=(0,t.up)("el-col"),c=(0,t.up)("el-row"),f=(0,t.up)("el-table-column"),w=(0,t.up)("el-table"),W=(0,t.up)("el-pagination"),Z=(0,t.up)("el-card"),F=(0,t.up)("el-option"),N=(0,t.up)("el-select"),J=(0,t.up)("el-checkbox"),Q=(0,t.up)("el-radio-button"),ue=(0,t.up)("el-radio-group"),_e=(0,t.up)("el-form"),ce=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(Z,{class:"card"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{gutter:"40"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{span:7},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"任务名称：",size:"small"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{clearable:"",placeholder:"请输入任务名称进行搜索",modelValue:z.value,"onUpdate:modelValue":r[0]||(r[0]=e=>z.value=e)},{append:(0,t.w5)((()=>[(0,t.Wm)(d,{icon:(0,u.SU)(o.Search),onClick:$},null,8,["icon"])])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(_,{span:7},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"任务ID：",size:"small"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{clearable:"",placeholder:"请输入任务ID进行搜索",modelValue:U.value,"onUpdate:modelValue":r[1]||(r[1]=e=>U.value=e)},{append:(0,t.w5)((()=>[(0,t.Wm)(d,{icon:(0,u.SU)(o.Search),onClick:S},null,8,["icon"])])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(_,{span:2},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{size:"small",disabled:""},{default:(0,t.w5)((()=>[(0,t.Uk)("已完成任务 "+(0,n.zw)(H.value)+" / 总任务 "+(0,n.zw)(x.value),1)])),_:1})])),_:1})])),_:1}),(0,t.Wm)(c,{class:"row"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{span:2},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{type:"primary",size:"small",disabled:T.value,onClick:L},{default:(0,t.w5)((()=>[(0,t.Uk)("批量删除")])),_:1},8,["disabled"])])),_:1}),(0,t.Wm)(_,{span:2},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{type:"primary",size:"small",onClick:r[2]||(r[2]=e=>b.value=!0)},{default:(0,t.w5)((()=>[(0,t.Uk)("添加漏洞验证任务")])),_:1})])),_:1})])),_:1}),(0,t.Wm)(w,{data:C.value,style:{width:"100%"},onSelectionChange:R,size:"small","highlight-current-row":""},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{type:"selection",prop:"select",width:"55",icon:"el-icon-question"}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,u.SU)(i.tY),((a,l)=>((0,t.wg)(),(0,t.j4)(f,{prop:a.prop,label:a.label,width:a.width,key:l},(0,t.Nv)({_:2},["scanning_start_time"==a.prop?{name:"default",fn:(0,t.w5)((({row:a})=>[(0,t.Uk)((0,n.zw)(e.$commons.trans_time2date(a.scanning_start_time)),1)])),key:"0"}:"name"==a.prop?{name:"default",fn:(0,t.w5)((({row:e})=>[(0,t._)("a",{style:{color:"red"},onClick:a=>me(e.domain_id)},(0,n.zw)(e.name),9,["onClick"])])),key:"1"}:"scanning_end_time"==a.prop?{name:"default",fn:(0,t.w5)((({row:a})=>[(0,t.Uk)((0,n.zw)(e.$commons.trans_time2date(a.scanning_end_time)),1)])),key:"2"}:"status"==a.prop?{name:"default",fn:(0,t.w5)((({row:e})=>[0==e.status?((0,t.wg)(),(0,t.j4)(d,{key:0,type:"primary",loading:"",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("pending")])),_:1})):1==e.status?((0,t.wg)(),(0,t.j4)(d,{key:1,type:"primary",color:"#626aef",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("finished")])),_:1})):(0,t.kq)("",!0),2==e.status?((0,t.wg)(),(0,t.j4)(d,{key:2,type:"primary",loading:"",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.module_status),1)])),_:2},1024)):(0,t.kq)("",!0)])),key:"3"}:"config"==a.prop?{name:"default",fn:(0,t.w5)((({row:e})=>[e.is_webscan?((0,t.wg)(),(0,t.iD)("div",{key:0},"webscan")):(0,t.kq)("",!0),e.is_portscan?((0,t.wg)(),(0,t.iD)("div",{key:1},"portscan")):(0,t.kq)("",!0),e.is_servicescan?((0,t.wg)(),(0,t.iD)("div",{key:2},"servicescan")):(0,t.kq)("",!0)])),key:"4"}:void 0]),1032,["prop","label","width"])))),128)),(0,t.Wm)(f,{fixed:"right",label:"操作",width:"300"},{default:(0,t.w5)((({row:e})=>[(0,t.Wm)(d,{type:"primary",size:"small",onClick:a=>me(e.domain_id)},{default:(0,t.w5)((()=>[(0,t.Uk)("查看详情")])),_:2},1032,["onClick"]),(0,t.Wm)(d,{type:"primary",size:"small",onClick:Y},{default:(0,t.w5)((()=>[(0,t.Uk)("重启")])),_:1}),(0,t.Wm)(d,{type:"primary",size:"small",onClick:a=>B(e.domain_id)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,t._)("div",y,[(0,t.Wm)(W,{"current-page":V.value.page_num,"onUpdate:current-page":r[3]||(r[3]=e=>V.value.page_num=e),"page-size":V.value.page_size,"onUpdate:page-size":r[4]||(r[4]=e=>V.value.page_size=e),"page-sizes":[10,20,30],small:a.value,disabled:s.value,background:l.value,layout:"total, sizes, prev, pager, next, jumper",total:q.value,onSizeChange:A,onCurrentChange:E,class:"navbar-right"},null,8,["current-page","page-size","small","disabled","background","total"])])])),_:1}),(0,t.Wm)(ce,{modelValue:b.value,"onUpdate:modelValue":r[19]||(r[19]=e=>b.value=e),title:"添加漏洞验证任务"},{footer:(0,t.w5)((()=>[(0,t.Wm)(_e,{ref_key:"task_data_form_ref",ref:P,model:I.value,size:"small",rules:(0,u.SU)(k)},{default:(0,t.w5)((()=>[(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"任务名称","label-width":"200px",required:"",prop:"task_name"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:I.value.task_name,"onUpdate:modelValue":r[5]||(r[5]=e=>I.value.task_name=e),autocomplete:"off",placeholder:"请输入任务名称"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"POC模块选择","label-width":"200px",prop:"task_web_poc"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:I.value.task_web_poc,"onUpdate:modelValue":r[6]||(r[6]=e=>I.value.task_web_poc=e),autocomplete:"off",disabled:ae.value,placeholder:"点击输入框进行选择POC模块",onClick:M},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"POC验证类型","label-width":"200px",required:""},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:de.value,"onUpdate:modelValue":r[7]||(r[7]=e=>de.value=e),placeholder:"请选择你要验证的类型",size:"small"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,u.SU)(i.R7),(e=>((0,t.wg)(),(0,t.j4)(F,{key:e.value,label:e.label,value:e.value,onClick:a=>pe(e.value)},null,8,["label","value","onClick"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"验证类型","label-width":"200px",required:""},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:re.value,"onUpdate:modelValue":r[8]||(r[8]=e=>re.value=e),placeholder:"请选择你要验证的类型"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,u.SU)(i.UB),(e=>((0,t.wg)(),(0,t.j4)(F,{key:e.value,label:e.label,value:e.value,onClick:a=>pe(e.value)},null,8,["label","value","onClick"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"代理扫描地址","label-width":"200px",prop:"task_proxy"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:I.value.task_proxy,"onUpdate:modelValue":r[9]||(r[9]=e=>I.value.task_proxy=e),autocomplete:"off",placeholder:"代理扫描地址，例如http://127.0.0.1:7890"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t._)("div",{class:(0,n.C_)({card_display:!se.value})},[(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"扫描ip段","label-width":"200px",prop:"task_target"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:I.value.task_target,"onUpdate:modelValue":r[10]||(r[10]=e=>I.value.task_target=e),autocomplete:"off",placeholder:"192.168.1.0/24"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"端口扫描格式","label-width":"200px"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:I.value.task_port_content,"onUpdate:modelValue":r[11]||(r[11]=e=>I.value.task_port_content=e),autocomplete:"off",placeholder:"空默认top100 或者 80,443 或者 80-89,443"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(_,{span:"12"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"服务利用","label-width":"200px"},{default:(0,t.w5)((()=>[(0,t.Wm)(J,{modelValue:I.value.task_service,"onUpdate:modelValue":r[12]||(r[12]=e=>I.value.task_service=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],2),(0,t._)("div",{class:(0,n.C_)({card_display:se.value})},[(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"空间搜索引擎语法","label-width":"200px",required:"",prop:"task_target"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:I.value.task_target,"onUpdate:modelValue":r[13]||(r[13]=e=>I.value.task_target=e),autocomplete:"off",placeholder:'请输入语法,比如title="apache"'},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)(_,{span:18},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"空间搜索引擎验证模式","label-width":"200px"},{default:(0,t.w5)((()=>[(0,t.Wm)(ue,{modelValue:j.value,"onUpdate:modelValue":r[14]||(r[14]=e=>j.value=e),onChange:D,required:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Q,{label:"fofa"},{default:(0,t.w5)((()=>[(0,t.Uk)("fofa验证")])),_:1}),(0,t.Wm)(Q,{label:"quake"},{default:(0,t.w5)((()=>[(0,t.Uk)("quake验证")])),_:1}),(0,t.Wm)(Q,{label:"hunter"},{default:(0,t.w5)((()=>[(0,t.Uk)("hunter验证")])),_:1}),(0,t.Wm)(Q,{label:"shodan"},{default:(0,t.w5)((()=>[(0,t.Uk)("shodan验证")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})],2)])),_:1},8,["model","rules"]),(0,t._)("span",g,[(0,t.Wm)(d,{type:"primary",onClick:r[15]||(r[15]=e=>K(P.value)),size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("提交")])),_:1}),(0,t.Wm)(d,{onClick:r[16]||(r[16]=e=>O(P.value)),size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(ce,{modelValue:h.value,"onUpdate:modelValue":r[18]||(r[18]=e=>h.value=e),width:"55%",title:"POC模块列表","append-to-body":"",size:"small"},{footer:(0,t.w5)((()=>[(0,t.Wm)(d,{type:"primary",onClick:le,size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1}),(0,t.Wm)(d,{onClick:te,size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1})])),default:(0,t.w5)((()=>[(0,t.Wm)(c,{gutter:"40"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"POC名称：",size:"small"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{clearable:"",modelValue:ne.value,"onUpdate:modelValue":r[17]||(r[17]=e=>ne.value=e),placeholder:"请输入POC名称进行搜索"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,t.Wm)(c,{gutter:"40",class:"row"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{type:"primary",onClick:oe,size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("全选")])),_:1})])),_:1})])),_:1}),(0,t.Wm)((0,u.SU)(v.y),{ref_key:"poc_ref",ref:ee,icon:(0,u.SU)(o.Search),data:G.value,props:X,"filter-node-method":ie,"node-key":"id","show-checkbox":"","highlight-current":""},null,8,["icon","data"])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])],64)}}}),h=l(89);const W=(0,h.Z)(b,[["__scopeId","data-v-614df91a"]]);var z=W}}]);
//# sourceMappingURL=632.c37435a3.js.map