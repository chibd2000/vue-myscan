"use strict";(self["webpackChunkvue3_element_plus_demo_test"]=self["webpackChunkvue3_element_plus_demo_test"]||[]).push([[153],{5178:function(e,a,t){t.d(a,{$M:function(){return r},UH:function(){return u},Yj:function(){return s},aH:function(){return i},gY:function(){return o},o:function(){return n},p7:function(){return p}});var l=t(2884);const u=e=>{const a={page_num:1,page_size:10,query:"",search_type:""};return a.page_num=e.page_num,a.page_size=e.page_size,a.search_type=e.search_type,""==e.query?a.query="null":a.query=e.query,l.Z.get(`/git/${a.search_type}/${a.page_num}/${a.page_size}/${a.query}`)},r=e=>l.Z.post("/git/allmonitor",e),i=e=>l.Z.post("/git/singlemonitor",{monitor_id:e}),n=e=>l.Z["delete"]("/git",{data:e}),o=e=>{const a={page_num:1,page_size:10,query:"",search_type:"",current_monitor_id:"",detail_type:""};return a.page_num=e.page_num,a.page_size=e.page_size,a.search_type=e.search_type,a.current_monitor_id=e.current_monitor_id,a.detail_type=e.detail_type,""==e.query?a.query="null":a.query=e.query,l.Z.get(`/gitdetail/${a.detail_type}/${a.search_type}/${a.current_monitor_id}/${a.page_num}/${a.page_size}/${a.query}`)},s=(e,a)=>l.Z.post(`/gitdetail/${e}`,{monitor_id:a}),p=e=>l.Z.get(`/gitdetail/overview/${e}`)},8153:function(e,a,t){t.r(a),t.d(a,{default:function(){return f}});t(7658);var l=t(3396),u=t(9242),r=t(4870),i=t(7139),n=t(2748),o=t(5178);const s=[{prop:"id",label:"序号",width:75},{prop:"target",label:"监控目标",width:200},{prop:"name",label:"监控名称",width:200},{prop:"status",label:"运行状态",width:100},{prop:"not_visited",label:"待查看",width:75},{prop:"last_update_time",label:"上次扫描时间",width:200},{prop:"next_update_time",label:"下次扫描时间",width:200},{prop:"create_time",label:"任务创建时间",width:200}],p=(0,r.qj)({task_name:[{message:"任务名称不能为空...",required:!0,trigger:"blur"}],task_target:[{message:"目标仓库不能为空...",required:!0,trigger:"blur"}]});var d=t(2483),m=t(7178);const _={class:"demo-pagination-block pagination-right"},c={class:"dialog-footer"};var g=(0,l.aZ)({__name:"Git",setup(e){const a=(0,r.iH)(!1),t=(0,r.iH)(!1),g=(0,r.iH)(!1),w=(0,r.iH)(!1),y=(0,r.iH)([]),f=(0,r.iH)(),v=(0,r.iH)({query:"",page_size:10,page_num:1,search_type:""}),k=(0,r.iH)(),h=(0,r.iH)({task_name:"",task_target:""}),z=(0,d.tv)(),b=e=>{sessionStorage.removeItem("current_tab"),z.push({path:"/gitdetail",query:{monitor_id:e}})},W=async e=>{await(0,o.aH)(e).then((()=>{(0,m.z8)({message:"提交手动监控成功",type:"success"})}),(e=>{(0,m.z8)({message:"提交手动监控失败",type:"error"})}))},U=async e=>{const a=[e];await(0,o.o)(a).then((()=>{(0,m.z8)({message:"删除任务成功",type:"success"})}),(e=>{(0,m.z8)({message:"删除任务失败",type:"error"})})),H("name")},q=async e=>{w.value=!0,e.validate((async a=>{if(!a)return!1;await(0,o.$M)(h.value).then((()=>{(0,m.z8)({message:"添加监控任务成功",type:"success"})}),(e=>{(0,m.z8)({message:"添加监控任务失败",type:"error"})})),w.value=!1,e.resetFields(),H("name")}))},$=(0,r.iH)(""),H=async e=>{"name"==e&&(v.value.search_type=e,v.value.query=$.value);const a=await(0,o.UH)(v.value);y.value=a.data.gits,f.value=a.data.total};H("name");const C=e=>{v.value.page_num=1,v.value.page_size=e,get_git_data()},V=e=>{v.value.page_num=e,get_git_data()};return(e,o)=>{const d=(0,l.up)("el-button"),m=(0,l.up)("el-input"),z=(0,l.up)("el-form-item"),Z=(0,l.up)("el-col"),j=(0,l.up)("el-row"),x=(0,l.up)("el-table-column"),S=(0,l.up)("el-table"),D=(0,l.up)("el-pagination"),Y=(0,l.up)("el-card"),K=(0,l.up)("el-form"),I=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(Y,{class:"card"},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{gutter:"40"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{span:7},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{label:"任务名称：",size:"small"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{clearable:"",placeholder:"请输入任务名称进行搜索",modelValue:$.value,"onUpdate:modelValue":o[1]||(o[1]=e=>$.value=e),onKeyup:o[2]||(o[2]=(0,u.D2)((e=>H("name")),["enter","native"]))},{append:(0,l.w5)((()=>[(0,l.Wm)(d,{icon:(0,r.SU)(n.Search),onClick:o[0]||(o[0]=e=>H("name"))},null,8,["icon"])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(j,{class:"row"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{span:3},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{type:"primary",size:"small",onClick:o[3]||(o[3]=e=>w.value=!0)},{default:(0,l.w5)((()=>[(0,l.Uk)("添加监控任务")])),_:1})])),_:1})])),_:1}),(0,l.Wm)(S,{data:y.value,style:{width:"100%"},size:"small","highlight-current-row":""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,r.SU)(s),((a,t)=>((0,l.wg)(),(0,l.j4)(x,{prop:a.prop,label:a.label,width:a.width,key:t},(0,l.Nv)({_:2},["status"==a.prop?{name:"default",fn:(0,l.w5)((({row:e})=>[0==e.status?((0,l.wg)(),(0,l.j4)(d,{key:0,disabled:"",round:"",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)("Pending")])),_:1})):1==e.status?((0,l.wg)(),(0,l.j4)(d,{key:1,disabled:"",round:"",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)("Running")])),_:1})):(0,l.kq)("",!0)])),key:"0"}:void 0,"last_update_time"==a.prop?{name:"default",fn:(0,l.w5)((({row:a})=>[(0,l.Uk)((0,i.zw)(e.$commons.trans_time2date(a.last_update_time)),1)])),key:"1"}:"next_update_time"==a.prop?{name:"default",fn:(0,l.w5)((({row:a})=>[(0,l.Uk)((0,i.zw)(e.$commons.trans_time2date(a.next_update_time)),1)])),key:"2"}:"create_time"==a.prop?{name:"default",fn:(0,l.w5)((({row:a})=>[(0,l.Uk)((0,i.zw)(e.$commons.trans_time2date(a.create_time)),1)])),key:"3"}:"not_visited"==a.prop?{name:"default",fn:(0,l.w5)((({row:e})=>[e.not_visited>0?((0,l.wg)(),(0,l.j4)(d,{key:0,disabled:"",round:"",size:"small",color:"red"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.not_visited),1)])),_:2},1024)):((0,l.wg)(),(0,l.j4)(d,{key:1,disabled:"",round:"",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.not_visited),1)])),_:2},1024))])),key:"4"}:void 0]),1032,["prop","label","width"])))),128)),(0,l.Wm)(x,{fixed:"right",label:"操作",width:"300"},{default:(0,l.w5)((({row:e})=>[(0,l.Wm)(d,{type:"primary",size:"small",onClick:a=>b(e.monitor_id)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看详情")])),_:2},1032,["onClick"]),(0,l.Wm)(d,{type:"primary",size:"small",onClick:a=>W(e.monitor_id)},{default:(0,l.w5)((()=>[(0,l.Uk)("手动监控")])),_:2},1032,["onClick"]),(0,l.Wm)(d,{type:"primary",size:"small",onClick:a=>U(e.monitor_id)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,l._)("div",_,[(0,l.Wm)(D,{"current-page":v.value.page_num,"onUpdate:current-page":o[4]||(o[4]=e=>v.value.page_num=e),"page-size":v.value.page_size,"onUpdate:page-size":o[5]||(o[5]=e=>v.value.page_size=e),"page-sizes":[10,20,30],small:a.value,disabled:g.value,background:t.value,total:f.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:C,onCurrentChange:V,class:"navbar-right"},null,8,["current-page","page-size","small","disabled","background","total"])])])),_:1}),(0,l.Wm)(I,{modelValue:w.value,"onUpdate:modelValue":o[11]||(o[11]=e=>w.value=e),title:"添加监控任务"},{footer:(0,l.w5)((()=>[(0,l._)("span",c,[(0,l.Wm)(d,{type:"primary",onClick:o[9]||(o[9]=e=>q(k.value)),size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)(" 提交 ")])),_:1}),(0,l.Wm)(d,{onClick:o[10]||(o[10]=e=>w.value=!1),size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(K,{ref_key:"task_data_form_ref",ref:k,model:h.value,size:"small",rules:(0,r.SU)(p)},{default:(0,l.w5)((()=>[(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[(0,l.Wm)(z,{label:"任务名称","label-width":"200px",required:"",prop:"task_name"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:h.value.task_name,"onUpdate:modelValue":o[6]||(o[6]=e=>h.value.task_name=e),autocomplete:"off",placeholder:"请输入任务名称"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[(0,l.Wm)(z,{label:"目标仓库","label-width":"200px",required:"",prop:"task_target"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:h.value.task_target,"onUpdate:modelValue":o[7]||(o[7]=e=>h.value.task_target=e),autocomplete:"off",placeholder:"请输入目标仓库",onKeyup:o[8]||(o[8]=(0,u.D2)((e=>q(k.value)),["enter","native"]))},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])],64)}}}),w=t(89);const y=(0,w.Z)(g,[["__scopeId","data-v-1a258cf9"]]);var f=y}}]);
//# sourceMappingURL=153.5d63e38d.js.map