"use strict";(self["webpackChunkvue3_element_plus_demo_test"]=self["webpackChunkvue3_element_plus_demo_test"]||[]).push([[17],{916:function(e,a,l){l.d(a,{Ir:function(){return d},Lp:function(){return r},Oj:function(){return s},bI:function(){return u},bU:function(){return n},eX:function(){return o},m9:function(){return i},qc:function(){return m}});var t=l(2884);const u=e=>{const a={page_num:1,page_size:1,query:"",search_type:""};return a.page_num=e.page_num,a.page_size=e.page_size,a.search_type=e.search_type,""==e.query?a.query="null":a.query=e.query,t.Z.get(`/task/${a.search_type}/${a.page_num}/${a.page_size}/${a.query}`)},n=e=>t.Z.post("/task",e),i=e=>t.Z["delete"]("/task",{data:e}),o=e=>t.Z.post("/common/website/export_website",{domain_id_list:e}),s=e=>t.Z.post("/common/ip/export_private_ip",{domain_id_list:e}),d=e=>t.Z.post("/common/ip/export_ip_port",{domain_id_list:e}),m=e=>t.Z.post("/common/subdomain/export_subdomain",{domain_id_list:e}),r=e=>t.Z.get(`/task/count/${e}`)},8842:function(e,a,l){l.d(a,{He:function(){return u},R7:function(){return n},UB:function(){return t},tY:function(){return i}});const t=[{value:"space",label:"空间搜索引擎验证"},{value:"ip",label:"IP/IP段验证"}],u=[{value:"1",label:"已完成"},{value:"0",label:"未完成"}],n=[{value:"attack",label:"探测和利用"},{value:"detect",label:"仅探测"},{value:"exec",label:"仅利用"}],i=[{prop:"name",label:"任务名称",width:150},{prop:"domain",label:"目标",width:225},{prop:"config",label:"配置项",width:150},{prop:"status",label:"状态",width:120},{prop:"scanning_start_time",label:"开始时间",width:200},{prop:"scanning_end_time",label:"结束时间",width:200},{prop:"domain_id",label:"任务ID",width:300}]},9017:function(e,a,l){l.r(a),l.d(a,{default:function(){return b}});l(7658);var t=l(3396),u=l(9242),n=l(4870),i=l(7139),o=l(2748);const s=[{prop:"name",label:"任务名称",width:150},{prop:"target",label:"目标",width:150},{prop:"config",label:"配置项",width:150},{prop:"status",label:"状态",width:160},{prop:"scanning_start_time",label:"开始时间",width:200},{prop:"scanning_end_time",label:"结束时间",width:200},{prop:"domain_id",label:"任务ID",width:300}];var d=l(916),m=l(7178),r=l(2655),p=l(2483),_=l(8842);const c=(0,n.qj)({task_name:[{message:"任务名称不能为空...",required:!0,trigger:"blur"}],task_target:[{message:"任务目标不能为空...",required:!0,trigger:"blur"}]}),w={class:"demo-pagination-block pagination-right"},v={class:"dialog-footer"};var k=(0,t.aZ)({__name:"Task",setup(e){const a=(0,p.tv)(),l=(0,n.iH)(!1),k=(0,n.iH)(!1),f=(0,n.iH)(!1),g=(0,n.iH)(!1),b=(0,n.iH)(""),y=(0,n.iH)(""),h=(0,n.iH)({query:"",page_size:10,page_num:1,search_type:""}),W=(0,n.iH)([]),z=(0,n.iH)(),U=(0,n.iH)(),V=(0,n.iH)(),C=async e=>{"name"==e?(h.value.search_type=e,h.value.query=b.value):"domainid"==e?(h.value.search_type=e,h.value.query=y.value):"status"==e?(h.value.search_type=e,h.value.query=q.value):"target"==e&&(h.value.search_type=e,h.value.query=x.value);const a=await(0,d.bI)(h.value);W.value=a.data.tasks,z.value=a.data.total;const l=await(0,d.Lp)("scan");U.value=l.data.finished,V.value=l.data.all_total};C("name");const x=(0,n.iH)(""),q=((0,n.iH)(""),(0,n.iH)("")),H=e=>{q.value=e,C("status")},D=(0,n.iH)(),I=(0,n.iH)({task_name:"",task_target:"",task_port_content:"",task_websearch:!0,task_ksubdomain:!1,task_service:!1,task_web:!1,task_web_poc_type:"",task_proxy:""}),S=async e=>{g.value=!0,e.validate((async a=>{if(!a)return!1;await(0,d.bU)(I.value).then((()=>{(0,m.z8)({message:"添加任务成功",type:"success"})}),(e=>{(0,m.z8)({message:"添加任务失败",type:"error"})})),g.value=!1,e.resetFields(),C("name")}))},j=async e=>{alert("this_is_restart_click"),C("name")},Z=async e=>{const a=[e];await(0,d.m9)(a).then((()=>{(0,m.z8)({message:"删除任务成功",type:"success"})}),(e=>{(0,m.z8)({message:"删除任务失败",type:"error"})})),C("name")},K=((0,n.iH)(),()=>{r.T.confirm("proxy will permanently delete the file. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{await(0,d.m9)(P.value).then((()=>{(0,m.z8)({message:"删除任务成功",type:"success"})}),(e=>{(0,m.z8)({message:"删除任务失败",type:"error"})})),C("name")})).catch((()=>{(0,m.z8)({type:"info",message:"Delete canceled"})}))}),$=async e=>{"website"==e?await(0,d.eX)(P.value):"subdomain"==e?await(0,d.qc)(P.value):"ip"==e?await(0,d.Oj)(P.value):"ip_port"==e&&await(0,d.Ir)(P.value),C("name")},P=(0,n.iH)([]),O=(0,n.iH)(!0),Y=(0,n.iH)(!0),B=e=>{e.length?(O.value=!1,Y.value=!1):(O.value=!0,Y.value=!0),P.value=[];for(let a=0;a<e.length;a++)P.value.push(e[a].domain_id)},T=e=>{h.value.page_num=1,h.value.page_size=e,C()},F=e=>{h.value.page_num=e,C()},L=e=>{sessionStorage.removeItem("current_tab"),a.push({path:"/detail",query:{domain_id:e}})},R=(0,n.iH)(),X=()=>{R.value.handleOpen()},E=(0,n.iH)("探测和利用"),N=e=>{"attack"==e?I.value.task_web_poc_type="attack":"detect"==e?I.value.task_web_poc_type="detect":"exec"==e&&(I.value.task_web_poc_type="exec")};return(e,a)=>{const d=(0,t.up)("el-button"),m=(0,t.up)("el-input"),r=(0,t.up)("el-form-item"),p=(0,t.up)("el-col"),P=(0,t.up)("el-option"),A=(0,t.up)("el-select"),G=(0,t.up)("el-row"),J=(0,t.up)("el-dropdown-item"),M=(0,t.up)("el-dropdown-menu"),Q=(0,t.up)("el-dropdown"),ee=(0,t.up)("el-table-column"),ae=(0,t.up)("el-table"),le=(0,t.up)("el-pagination"),te=(0,t.up)("el-card"),ue=(0,t.up)("el-checkbox"),ne=(0,t.up)("el-form"),ie=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(te,{class:"card"},{default:(0,t.w5)((()=>[(0,t.Wm)(G,{gutter:"40"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{span:7},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"任务名称：",size:"small"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{clearable:"",placeholder:"请输入站点名称进行搜索",modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=e=>b.value=e),onKeyup:a[2]||(a[2]=(0,u.D2)((e=>C("name")),["enter","native"]))},{append:(0,t.w5)((()=>[(0,t.Wm)(d,{icon:(0,n.SU)(o.Search),onClick:a[0]||(a[0]=e=>C("name"))},null,8,["icon"])])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(p,{span:7},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"任务状态：",size:"small"},{default:(0,t.w5)((()=>[(0,t.Wm)(A,{modelValue:q.value,"onUpdate:modelValue":a[3]||(a[3]=e=>q.value=e),placeholder:"请选择你要验证的类型"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(_.He),(e=>((0,t.wg)(),(0,t.j4)(P,{key:e.value,label:e.label,value:e.value,onClick:a=>H(e.value)},null,8,["label","value","onClick"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,t.Wm)(G,null,{default:(0,t.w5)((()=>[(0,t.Wm)(p,{span:6},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"任务ID：",size:"small"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{clearable:"",placeholder:"请输入任务ID进行搜索",modelValue:y.value,"onUpdate:modelValue":a[5]||(a[5]=e=>y.value=e),onKeyup:a[6]||(a[6]=(0,u.D2)((e=>C("domainid")),["enter","native"]))},{append:(0,t.w5)((()=>[(0,t.Wm)(d,{icon:(0,n.SU)(o.Search),onClick:a[4]||(a[4]=e=>C("domainid"))},null,8,["icon"])])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(p,{span:6},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"任务目标：","label-width":"100px",size:"small"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{clearable:"",placeholder:"请输入任务目标进行搜索",modelValue:x.value,"onUpdate:modelValue":a[8]||(a[8]=e=>x.value=e),onKeyup:a[9]||(a[9]=(0,u.D2)((e=>C("target")),["enter","native"]))},{append:(0,t.w5)((()=>[(0,t.Wm)(d,{icon:(0,n.SU)(o.Search),onClick:a[7]||(a[7]=e=>C("target"))},null,8,["icon"])])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(p,{span:3},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{"label-width":"50px",size:"small"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{size:"small",disabled:""},{default:(0,t.w5)((()=>[(0,t.Uk)("已完成任务 "+(0,i.zw)(U.value)+" / 总任务 "+(0,i.zw)(V.value),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(G,{class:"row"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{span:2},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{disabled:O.value,type:"primary",size:"small",onClick:K},{default:(0,t.w5)((()=>[(0,t.Uk)("批量删除")])),_:1},8,["disabled"])])),_:1}),(0,t.Wm)(Q,{ref_key:"export_down_menu",ref:R,trigger:"contextmenu",style:{"margin-right":"30px"},size:"small"},{dropdown:(0,t.w5)((()=>[(0,t.Wm)(M,null,{default:(0,t.w5)((()=>[(0,t.Wm)(J,{onClick:a[10]||(a[10]=e=>$("website"))},{default:(0,t.w5)((()=>[(0,t.Uk)("批量存活站点")])),_:1}),(0,t.Wm)(J,{onClick:a[11]||(a[11]=e=>$("subdomain"))},{default:(0,t.w5)((()=>[(0,t.Uk)("批量导出子域名")])),_:1}),(0,t.Wm)(J,{onClick:a[12]||(a[12]=e=>$("ip"))},{default:(0,t.w5)((()=>[(0,t.Uk)("批量导出内网IP")])),_:1}),(0,t.Wm)(J,{onClick:a[13]||(a[13]=e=>$("ip_port"))},{default:(0,t.w5)((()=>[(0,t.Uk)("批量导出IP+端口")])),_:1})])),_:1})])),default:(0,t.w5)((()=>[(0,t.Wm)(d,{onClick:X,type:"primary",size:"small",disabled:Y.value},{default:(0,t.w5)((()=>[(0,t.Uk)("批量导出数据")])),_:1},8,["disabled"])])),_:1},512),(0,t.Wm)(p,{span:3},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{type:"primary",size:"small",onClick:a[14]||(a[14]=e=>g.value=!0)},{default:(0,t.w5)((()=>[(0,t.Uk)("添加扫描任务")])),_:1})])),_:1})])),_:1}),(0,t.Wm)(ae,{data:W.value,style:{width:"100%"},onSelectionChange:B,size:"small","highlight-current-row":""},{default:(0,t.w5)((()=>[(0,t.Wm)(ee,{type:"selection",prop:"select",width:"55",icon:"el-icon-question"}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(s),((a,l)=>((0,t.wg)(),(0,t.j4)(ee,{prop:a.prop,label:a.label,width:a.width,key:l},(0,t.Nv)({_:2},["scanning_start_time"==a.prop?{name:"default",fn:(0,t.w5)((({row:a})=>[(0,t.Uk)((0,i.zw)(e.$commons.trans_time2date(a.scanning_start_time)),1)])),key:"0"}:"name"==a.prop?{name:"default",fn:(0,t.w5)((({row:e})=>[(0,t._)("a",{style:{color:"red"},onClick:a=>L(e.domain_id)},(0,i.zw)(e.name),9,["onClick"])])),key:"1"}:"scanning_end_time"==a.prop?{name:"default",fn:(0,t.w5)((({row:a})=>[(0,t.Uk)((0,i.zw)(e.$commons.trans_time2date(a.scanning_end_time)),1)])),key:"2"}:"status"==a.prop?{name:"default",fn:(0,t.w5)((({row:e})=>[0==e.status?((0,t.wg)(),(0,t.j4)(d,{key:0,type:"primary",loading:"",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("Pending")])),_:1})):1==e.status?((0,t.wg)(),(0,t.j4)(d,{key:1,type:"primary",color:"#626aef",size:"small",round:""},{default:(0,t.w5)((()=>[(0,t.Uk)("Finished")])),_:1})):(0,t.kq)("",!0),2==e.status?((0,t.wg)(),(0,t.j4)(d,{key:2,type:"primary",loading:"",size:"small",round:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.module_status),1)])),_:2},1024)):(0,t.kq)("",!0)])),key:"3"}:"config"==a.prop?{name:"default",fn:(0,t.w5)((({row:e})=>[e.is_ksubdomain?((0,t.wg)(),(0,t.iD)("div",{key:0},"ksubdomain")):(0,t.kq)("",!0),e.is_websearch?((0,t.wg)(),(0,t.iD)("div",{key:1},"websearch")):(0,t.kq)("",!0),e.is_portscan?((0,t.wg)(),(0,t.iD)("div",{key:2},"portscan")):(0,t.kq)("",!0),e.is_webscan?((0,t.wg)(),(0,t.iD)("div",{key:3},"webscan")):(0,t.kq)("",!0),e.is_servicescan?((0,t.wg)(),(0,t.iD)("div",{key:4},"servicescan")):(0,t.kq)("",!0)])),key:"4"}:void 0]),1032,["prop","label","width"])))),128)),(0,t.Wm)(ee,{fixed:"right",label:"操作",width:"300"},{default:(0,t.w5)((({row:e})=>[(0,t.Wm)(d,{type:"primary",size:"small",onClick:a=>L(e.domain_id)},{default:(0,t.w5)((()=>[(0,t.Uk)("查看详情")])),_:2},1032,["onClick"]),(0,t.Wm)(d,{type:"primary",size:"small",onClick:j},{default:(0,t.w5)((()=>[(0,t.Uk)("重启")])),_:1}),(0,t.Wm)(d,{type:"primary",size:"small",onClick:a=>Z(e.domain_id)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,t._)("div",w,[(0,t.Wm)(le,{"current-page":h.value.page_num,"onUpdate:current-page":a[15]||(a[15]=e=>h.value.page_num=e),"page-size":h.value.page_size,"onUpdate:page-size":a[16]||(a[16]=e=>h.value.page_size=e),"page-sizes":[10,20,30],small:l.value,disabled:f.value,background:k.value,total:z.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:T,onCurrentChange:F},null,8,["current-page","page-size","small","disabled","background","total"])])])),_:1}),(0,t.Wm)(ie,{modelValue:g.value,"onUpdate:modelValue":a[27]||(a[27]=e=>g.value=e),title:"添加扫描任务"},{footer:(0,t.w5)((()=>[(0,t._)("span",v,[(0,t.Wm)(d,{type:"primary",onClick:a[25]||(a[25]=e=>S(D.value)),size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)(" 提交 ")])),_:1}),(0,t.Wm)(d,{onClick:a[26]||(a[26]=e=>g.value=!1),size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(ne,{ref_key:"task_data_form_ref",ref:D,model:I.value,size:"small",rules:(0,n.SU)(c)},{default:(0,t.w5)((()=>[(0,t.Wm)(G,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"任务名称","label-width":"200px",required:"",prop:"task_name"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:I.value.task_name,"onUpdate:modelValue":a[17]||(a[17]=e=>I.value.task_name=e),autocomplete:"off",placeholder:"请输入任务名称"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(G,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"目标","label-width":"200px",required:"",prop:"task_target"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:I.value.task_target,"onUpdate:modelValue":a[18]||(a[18]=e=>I.value.task_target=e),autocomplete:"off",placeholder:"请输入目标,比如hengge.com"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(G,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"POC验证类型","label-width":"200px",required:""},{default:(0,t.w5)((()=>[(0,t.Wm)(A,{modelValue:E.value,"onUpdate:modelValue":a[19]||(a[19]=e=>E.value=e),placeholder:"请选择你要验证的类型",size:"small"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(_.R7),(e=>((0,t.wg)(),(0,t.j4)(P,{key:e.value,label:e.label,value:e.value,onClick:a=>N(e.value)},null,8,["label","value","onClick"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(G,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"端口扫描格式","label-width":"200px"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:I.value.task_port_content,"onUpdate:modelValue":a[20]||(a[20]=e=>I.value.task_port_content=e),autocomplete:"off",placeholder:"空默认top100 或者 80,443 或者 80-89,443"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(G,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{label:"代理扫描地址","label-width":"200px"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:I.value.task_proxy,"onUpdate:modelValue":a[21]||(a[21]=e=>I.value.task_proxy=e),autocomplete:"off",placeholder:"代理扫描地址，例如http://127.0.0.1:7890"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(G,null,{default:(0,t.w5)((()=>[(0,t.Wm)(p,{span:5},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{"label-width":"150px"},{default:(0,t.w5)((()=>[(0,t.Wm)(ue,{modelValue:I.value.task_ksubdomain,"onUpdate:modelValue":a[22]||(a[22]=e=>I.value.task_ksubdomain=e)},{default:(0,t.w5)((()=>[(0,t.Uk)("域名爆破")])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(p,{span:5},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{"label-width":"150px"},{default:(0,t.w5)((()=>[(0,t.Wm)(ue,{modelValue:I.value.task_service,"onUpdate:modelValue":a[23]||(a[23]=e=>I.value.task_service=e)},{default:(0,t.w5)((()=>[(0,t.Uk)("服务利用")])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(p,{span:5},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{"label-width":"150px"},{default:(0,t.w5)((()=>[(0,t.Wm)(ue,{modelValue:I.value.task_web,"onUpdate:modelValue":a[24]||(a[24]=e=>I.value.task_web=e)},{default:(0,t.w5)((()=>[(0,t.Uk)("WEB利用")])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])],64)}}}),f=l(89);const g=(0,f.Z)(k,[["__scopeId","data-v-1b4ab722"]]);var b=g}}]);
//# sourceMappingURL=17.4cd4484c.js.map